<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Node-xyz.GitHub.io by node-xyz</title>

    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="/">Node XYZ</a></h1>
        <p>Microservice toolkit for node</p>

        <h4>View on github</h4>
        <ul>
          <li>
            <a href="https://github.com/node-xyz"> Node XYZ </a>
          </li>
          <li>
              <a href="https://github.com/node-xyz/xyz-core">XYZ-core</a>
          </li>
          <li>
              <a href="https://github.com/node-xyz/xyz-cli">XYZ-cli</a>
          </li>
        </ul>

        <h4>Documentation</h4>
        <ul>
          <li>
            Getting started
            <ul>
              <li><a href="/getting-started/hello-xyz">Hello XYZ</a></li>
              <li><a href="/getting-started/replicating">Replicate your services</a></li>
              <li>Who is where? </li>
              <li>Path based services</li>
              <li>Middlewares</li>
            </ul>
          </li>
          <li>Read the wiki</li>
          <li>API Doc</li>
        </ul>

      </header>
      <section>
        <h1>Hello XYZ</h2>
        <p>
          This brief tutorial will help you fathom the concepts of XYZ, and help you get started with it.
        </p>
        <h3>Baby Microservice</h3>
        <p>
          Assume that we only have two services that will communicate with each other. Suppose that each of these services (aka Node modules) have another API exposed two end users. That is not our business at the moment, since as mentioned before, XYZ will divide the matter of end user and the matter of system. Now, our goal is to focus on what is important to our own system.
        </p>

        <p>
          The -- dummy services are as follows:
        </p>

        <pre>
<code>// math.ms.js
// a very fancy math module with super fast calculation
function add(x, y) {
return x + y
}

function mul(x, y) {
  return x * y
}

// string.ms.js
// some ultra hard string manipulations
function up(str) {
  return s.toUpperCase()
}
function down(str) {
  return s.toLowerCase()
}</code>
        </pre>

        <p>
          Now, assume that these services need to call each other in order to share their services. This is the first place that XYZ will come to action.
        </p>

        <p>
          In order to have two xyz instances communicate with each other, they need to have a system, a shared system. Information about the system is filled to the xyz instance using a config parameter. The config parameter has information such as local port/it/serviceName and a list of nodes who live inside the system. Note that a node can join the system without being in the static list, this is just a basic example!
        </p>

        <pre>
<code>// math.ms.js
// a very fancy math module with super fast calculation
let xyz = require('xyz-core')
let mathMS = new xyz({
  selfConf: {
    name: 'MathMS',
    host: '127.0.0.1',
    port: 3333
  },
  systemConf: {
    microservices: [{
        host: '127.0.0.1',
        port: 3334
      }]
  }
})

mathMS.register('mul', (payload, response) => {
  response.send(payload.x * payload.y)
})

mathMS.register('add', (payload, response) => {
  response.send(payload.x + payload.y)
})



// string.ms.js
// some ultra hard string manipulations
let xyz = require('xyz-core')
let stringMS = new xyz({
  selfConf: {
    name: 'stringMS',
    host: '127.0.0.1',
    port: 3334
  },
  systemConf: {
    microservices: [{
        host: '127.0.0.1',
        port: 3333
      }]
  }
})
stringMS.register('up', (payload, response) => {
  response.send(payload.toUpperCase())
})
stringMS.register('down', (payload, response) => {
  response.send(payload.toLowerCase())
})
</code>
        </pre>
        <blockquote cite="">
          The entire process of initializing a system and passing all of the parameters seems too much of a duplicate. We agree! check out the best practices section#common.js
        </blockquote>

        <p>
          And that's it! Now, our services are virtually binded to one another and they can call the service that each of them expose using <code>.register</code>
        </p>


        <h4>A Note on terminology.</h4>

        <p>
          Words and phrases in XYZ system are explained in Wiki page. Just to recap, each function exposed via <code>.register</code> is a <em>service</em>. <br> Each <strong>Node Process</strong>, having a number of services is called a <strong>node</strong> (or in some places a <em>microservice</em>, but its just temporary).
        </p>

        <p>
          Back to out little system. Now, one of these system can call a service in the other system using the <code>.call</code>
        </p>
<pre>
  <code>
//stringMS
// note that these callback styles are inherited from node's native http module.
// `resp` is the IncomingMessage instance etc.
stringMS.call('mul', {x: 2, y:5}, (err, body, res) => {
  console.log(`my fellow service responded with ${body}`)
})
  </code>
</pre>

      <p>
        You should now see an output like: <br>
        <code>my fellow service responded with 10</code>
      </p>

      <h3>What's next?</h3>

      <p>
        In this example we hardcoded the list of service, so that they can communicate with each other. This... just about ok. It is not awesome. What would be awesome is to have nodes joining the system dynamically. Yes, that's what we're going to do in the<a href="/replicating"> Next Section</a>.
      </p>
      </section>
      <footer>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/javascripts/scale.fix.js"></script>

  </body>
</html>
